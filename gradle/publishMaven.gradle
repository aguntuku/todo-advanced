apply plugin: 'maven'

ext.artifactoryContextUrl = 'http://localhost:8081/artifactory' 
ext.artifactoryRepository = 'libs-release-local'
ext.artifactoryFullRepoUrl = "$artifactoryContextUrl/$artifactoryRepository"
ext.artifactoryUsername = 'admin'
ext.artifactoryPassword = 'password'

uploadArchives {		
    repositories.mavenDeployer {
        repository(url: artifactoryFullRepoUrl) {
            authentication(userName: artifactoryUsername, password: artifactoryPassword)
        }
    }
}

repositories {
	maven {
		url artifactoryFullRepoUrl
	}
}

configurations {
	deployable
}

dependencies {
	deployable "com.manning.gia:todo:${project.version.toString()}"
}

task downloadBinaryArchive(type: Copy) {
	from configurations.deployable.singleFile()
	into buildDir
}